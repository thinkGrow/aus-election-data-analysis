---
title: "ETC5512: Assignment 2"
author: "ADD YOUR NAME HERE" 
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
```

```{r}
install.packages("sf")
```

### Task 1 : **Support for Independent Candidates**

#### 1. Load the dataset

```{r}
# Load necessary packages
library(tidyverse)

# Read in the data
votes_2019 <- read_csv("data/election_by_division_2019.csv")
votes_2022 <- read_csv("data/election_by_division_2022.csv")

#dim(votes_2019)
#dim(votes_2022)

# Add a column to indicate the election year
votes_2019 <- votes_2019 %>% mutate(election_year = 2019)
votes_2022 <- votes_2022 %>% mutate(election_year = 2022)

combined_votes <- bind_rows(votes_2019, votes_2022)

#head(combined_votes)

write_csv(combined_votes, "data/combined_votes_2019_2022.csv")


#dim(combined_votes)
```

#### 2. Independent new/held/lost

Determine for each electoral **division** whether it was:

-   **Held** by an Independent (won in both 2019 & 2022)

-   **Gained/New** (not won in 2019, but won in 2022)

-   **Lost** (won in 2019, but not in 2022)

Filter independent candidates

```{r}
ind_votes <- combined_votes %>%
  filter(PartyAb == "IND")

```

**Winners by division** per year.

```{r}
top_candidates <- combined_votes %>%
  group_by(election_year, DivisionId) %>%
  filter(Votes == max(Votes)) %>%
  ungroup()

top_candidates
```

Dataset of winners who were independent

```{r}
ind_wins <- top_candidates %>%
  filter(PartyAb == "IND") %>%
  select(DivisionId, DivisionName, election_year)

```

Pivot to compare 2019 vs 2022 side-by-side

```{r}
ind_wins_pivot <- ind_wins %>%
  mutate(ind_won = TRUE) %>%
  pivot_wider(names_from = election_year, values_from = ind_won, names_prefix = "year_")

```

Classify the outcome per division

```{r}
ind_wins_pivot <- ind_wins_pivot %>%
  mutate(status = case_when(
    year_2019 == TRUE & year_2022 == TRUE ~ "Held",
    is.na(year_2019) & year_2022 == TRUE ~ "Gained/New",
    year_2019 == TRUE & is.na(year_2022) ~ "Lost",
    TRUE ~ "Other"
  ))

ind_wins_pivot
```

#### 3. For each **division won by independents in 2022**, determine:

-   Which **party** held that seat in **2019**

Seats won by independents in 2022

```{r}
ind_2022_wins <- combined_votes %>%
  filter(election_year == 2022) %>%
  group_by(DivisionId) %>%
  filter(Votes == max(Votes)) %>%
  ungroup() %>%
  filter(PartyAb == "IND") %>%
  select(DivisionId, DivisionName)

```

2019 winners for those divisions

```{r}
winners_2019 <- combined_votes %>%
  filter(election_year == 2019) %>%
  group_by(DivisionId) %>%
  filter(Votes == max(Votes)) %>%
  ungroup() %>%
  select(DivisionId, DivisionName, PartyAb)  # 2019 winners

```

Join the winners

```{r}
ind_2022_previous_parties <- ind_2022_wins %>%
  left_join(winners_2019, by = c("DivisionId", "DivisionName")) %>%
  rename(Previous_Party_2019 = PartyAb)

ind_2022_previous_parties
```

#### 4. Votes for non-major parties

Filter for candidates NOT from the two major parties

```{r}

non_major_votes <- combined_votes %>%
  filter(!(PartyAb %in% c("ALP", "LP", "NA")))  # Exclude Labor, Liberal, and Informal

```

Pros and Cons

| **Aspect** | **Raw Vote Counts** | **Percentage of Votes** |
|------------|---------------------|-------------------------|

|             |                                                                                |                                                             |
|-------------|--------------------------------------------------------------------------------|-------------------------------------------------------------|
| ✅ **Pros** | Shows **actual volume** of support --- useful for seeing how many people voted | Accounts for **differences in population** across divisions |

|             |                                                                                                                     |                                                                                                        |
|-------------|---------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| ❌ **Cons** | Doesn't account for **division size** --- 10,000 votes in one place could be a landslide or insignificant elsewhere | Can **hide growth** if population changed --- a stable percentage may still mean thousands more people |

### Task 2

Put you Task 2 answers here

### Citations

Add you citations here

### AI acknowledgment

Share you AI acknowledgement and queries here
